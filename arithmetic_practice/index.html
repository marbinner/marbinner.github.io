<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Math Practice</title>
    <style>
        body{font-family:Arial,sans-serif;display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh;background-color:#f4f4f9;margin:0;overflow:hidden}#controls,#info{position:absolute;top:20px;background:#fff;padding:15px;border-radius:10px;box-shadow:0 0 15px rgba(0,0,0,.1);font-size:16px}#controls{left:20px}#controls label{display:block;margin-bottom:10px}#controls input,#controls select{width:60px;padding:5px;margin-top:5px;border:1px solid #ccc;border-radius:5px;font-size:14px;display:inline-block}#controls input[type=checkbox],#controls input[type=button]{width:auto}#info{right:20px;text-align:right;width:200px}#info div{margin-bottom:10px}#progress-container{position:absolute;top:20px;left:50%;transform:translateX(-50%);width:80%;max-width:600px;height:30px;background-color:#ddd;border-radius:15px;overflow:hidden}#progress-bar{height:100%;width:100%;background-color:#4caf50;border-radius:15px;transition:width 1s linear}#cpm-display{position:absolute;top:60px;left:50%;transform:translateX(-50%);font-size:24px;font-weight:700;color:#333}#question-area{text-align:center;font-size:48px;color:#333;transition:background-color .2s;background-color:#ddd;padding:20px;border-radius:10px;width:600px;font-family:'Courier New',monospace}#question-area.started{background-color:transparent}#answer{font-size:48px;width:200px;text-align:center;border:none;border-bottom:2px solid #333;background:0 0;outline:0;margin-bottom:20px;font-family:'Courier New',monospace}#answer::-webkit-inner-spin-button,#answer::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}#answer[type=number]{-moz-appearance:textfield}#upcoming-questions{margin-top:0}.upcoming-question{opacity:.6;transition:opacity .3s;font-family:'Courier New',monospace}.upcoming-question:nth-child(2){opacity:.4}.upcoming-question:nth-child(3){opacity:.2}.question{white-space:pre;letter-spacing:-5px}.history-row:nth-child(odd){background-color:#f4f4f4}.history-row:nth-child(even){background-color:#e0e0e0}.history-row{padding:5px;text-align:center;font-size:16px}
    </style>
</head>
<body>
    <div id="controls">
        <label>Time: <select id="timeSelect"><option value="60">60s</option><option value="120">120s</option></select></label>
        <label><input type="checkbox" id="addition" checked>Addition <input type="number" id="addMin1" value="2"><input type="number" id="addMax1" value="9"><input type="number" id="addMin2" value="11"><input type="number" id="addMax2" value="99"></label>
        <label><input type="checkbox" id="subtraction">Subtraction <input type="number" id="subMin1" value="2"><input type="number" id="subMax1" value="9"><input type="number" id="subMin2" value="11"><input type="number" id="subMax2" value="99"></label>
        <label><input type="checkbox" id="multiplication" checked>Multiplication <input type="number" id="mulMin1" value="2"><input type="number" id="mulMax1" value="9"><input type="number" id="mulMin2" value="11"><input type="number" id="mulMax2" value="99"></label>
        <label><input type="checkbox" id="division">Division <input type="number" id="divMin1" value="2"><input type="number" id="divMax1" value="9"><input type="number" id="divMin2" value="11"><input type="number" id="divMax2" value="99"></label>
        <label><input type="checkbox" id="squares">Squares <input type="number" id="squaresMin" value="2"><input type="number" id="squaresMax" value="9"></label>
        <label><input type="checkbox" id="bayes">Bayesian Updates <input type="number" id="bayesMin" value="1"><input type="number" id="bayesMax" value="10"></label>
        <label><input type="checkbox" id="oddsToProb">Odds to Probability <input type="number" id="oddsToProbMin" value="1"><input type="number" id="oddsToProbMax" value="10"></label>
        <label><input type="button" id="toggleSound" value="Sound: Off" onclick="toggleSound()"></label>
    </div>
    <div id="info"><div id="cpm-history"></div></div>
    <div id="progress-container"><div id="progress-bar"></div></div>
    <div id="cpm-display">CPM: 0</div>
    <div id="question-area">
        <input autocomplete="off" type="text" id="answer" onkeydown="restartOnEnter(event)" oninput="checkAnswer()">
        <div id="question" class="question"></div>
        <div id="upcoming-questions"></div>
    </div>
    <audio id="click-sound" src="res/sound.wav"></audio>
    <script>
        let correctAnswer,score=0,total=0,timer,timerStarted=!1,soundEnabled=!1;const upcomingQuestions=[],cpmHistory=[];function getRandomInt(e,t){return Math.floor(Math.random()*(t-e+1))+e}function gcd(e,t){return 0===t?e:gcd(t,e%t)}function simplifyFraction(e,t){const n=gcd(e,t);return[e/n,t/n]}function generateSimplifiedFraction(e,t){let n=getRandomInt(e,t),o=getRandomInt(e,t);return simplifyFraction(n,o)}function roundToTwoDecimalPlaces(e){return Math.round(100*e)/100}function generateQuestion(){const e=[];document.getElementById("addition").checked&&e.push("+"),document.getElementById("subtraction").checked&&e.push("-"),document.getElementById("multiplication").checked&&e.push("*"),document.getElementById("division").checked&&e.push("/"),document.getElementById("squares").checked&&e.push("^2"),document.getElementById("bayes").checked&&e.push("bayes"),document.getElementById("oddsToProb").checked&&e.push("oddsToProb");const t=e[Math.floor(Math.random()*e.length)];switch(t){case"+":const n=parseInt(document.getElementById("addMin1").value)||2,o=parseInt(document.getElementById("addMax1").value)||9,a=parseInt(document.getElementById("addMin2").value)||11,d=parseInt(document.getElementById("addMax2").value)||99,i=getRandomInt(n,o),u=getRandomInt(a,d);return Math.random()<.5?{question:`${i} + ${u}`,answer:i+u}:{question:`${u} + ${i}`,answer:i+u};case"-":const c=parseInt(document.getElementById("subMin1").value)||2,l=parseInt(document.getElementById("subMax1").value)||9,s=parseInt(document.getElementById("subMin2").value)||11,m=parseInt(document.getElementById("subMax2").value)||99,r=getRandomInt(c,l),h=getRandomInt(s,m);return Math.random()<.5?{question:`${r} - ${h}`,answer:r-h}:{question:`${h} - ${r}`,answer:h-r};case"*":const p=parseInt(document.getElementById("mulMin1").value)||2,g=parseInt(document.getElementById("mulMax1").value)||9,I=parseInt(document.getElementById("mulMin2").value)||11,v=parseInt(document.getElementById("mulMax2").value)||99,M=getRandomInt(p,g),x=getRandomInt(I,v);return Math.random()<.5?{question:`${M} * ${x}`,answer:M*x}:{question:`${x} * ${M}`,answer:M*x};case"/":const y=parseInt(document.getElementById("divMin1").value)||2,f=parseInt(document.getElementById("divMax1").value)||9,E=parseInt(document.getElementById("divMin2").value)||11,q=parseInt(document.getElementById("divMax2").value)||99,R=getRandomInt(y,f),L=getRandomInt(E,q),w=R*L;return Math.random()<.5?{question:`${w} / ${R}`,answer:L}:{question:`${w} / ${L}`,answer:R};case"^2":const b=parseInt(document.getElementById("squaresMin").value)||2,H=parseInt(document.getElementById("squaresMax").value)||9,S=getRandomInt(b,H);return{question:`${S}^2`,answer:S*S};case"bayes":const T=parseInt(document.getElementById("bayesMin").value)||1,A=parseInt(document.getElementById("bayesMax").value)||10,[B,C]=generateSimplifiedFraction(T,A),[D,F]=generateSimplifiedFraction(T,A),G=B*D,J=C*F,[K,N]=simplifyFraction(G,J);return{question:`${B}:${C}, ${D}:${F}`,answer:`${K}:${N}`};case"oddsToProb":const O=parseInt(document.getElementById("oddsToProbMin").value)||1,P=parseInt(document.getElementById("oddsToProbMax").value)||10,[Q,U]=generateSimplifiedFraction(O,P),V=Q/(Q+U),W=Math.round(100*V);return{question:`${Q}:${U}`,answer:W}}}function updateUpcomingQuestions(){const e=document.getElementById("upcoming-questions");e.innerHTML="";for(let t=1;t<upcomingQuestions.length;t++){const n=document.createElement("div");n.className="upcoming-question question",n.innerText=upcomingQuestions[t].question,e.appendChild(n)}}function checkAnswer(){const e=document.getElementById("answer").value,t=upcomingQuestions[0].question.split(",")[0].split(":")[0];if(e===correctAnswer.toString()||"bayes"===t&&e===correctAnswer||"oddsToProb"===generateQuestion().question.split(":")[0]&&parseInt(e)===correctAnswer){soundEnabled&&playClickSound(),score++,total++,upcomingQuestions.shift();const e=generateQuestion();upcomingQuestions.push(e),correctAnswer=upcomingQuestions[0].answer,document.getElementById("question").innerText=upcomingQuestions[0].question,document.getElementById("answer").value="",updateUpcomingQuestions(),timerStarted||startTimer()}}function playClickSound(){const e=document.getElementById("click-sound");e.currentTime=0,e.play()}function toggleSound(){soundEnabled=!soundEnabled,document.getElementById("toggleSound").value=soundEnabled?"Sound: On":"Sound: Off"}function startTimer(){timerStarted=!0,score=0,total=0;const e=parseInt(document.getElementById("timeSelect").value);document.getElementById("cpm-display").innerText="CPM: 0",document.getElementById("question-area").classList.add("started");const t=document.getElementById("progress-bar");t.style.width="100%";const n=1e3*e,o=100/e;timer=setInterval(()=>{const n=parseInt(document.querySelector("#progress-bar").style.width.replace("%",""));if(n>0){t.style.width=`${n-o}%`;let a=Math.floor(score/(e-n/o)*60);(isNaN(a)||!isFinite(a))&&(a=0),document.getElementById("cpm-display").innerText=`CPM: ${a}`}else{clearInterval(timer);let t=Math.floor(score/e*60);(isNaN(t)||!isFinite(t))&&(t=0),cpmHistory.push(t),updateCpmHistory(),setTimeout(()=>{initializePractice()},500)}},1e3)}function updateCpmHistory(){const e=document.getElementById("cpm-history");e.innerHTML="",cpmHistory.forEach(t=>{const n=document.createElement("div");n.className="history-row",n.innerText=t,e.appendChild(n)})}function restartOnEnter(e){"Enter"===e.key&&(initializePractice(),document.getElementById("answer").focus())}function initializePractice(){clearInterval(timer),timerStarted=!1,document.getElementById("question-area").classList.remove("started"),document.getElementById("answer").value="",document.getElementById("cpm-display").innerText="CPM: 0",upcomingQuestions.length=0,document.getElementById("progress-bar").style.width="100%";for(let e=0;e<4;e++)upcomingQuestions.push(generateQuestion());correctAnswer=upcomingQuestions[0].answer,document.getElementById("question").innerText=upcomingQuestions[0].question,updateUpcomingQuestions(),document.getElementById("answer").focus()}document.addEventListener("DOMContentLoaded",e=>{initializePractice(),document.getElementById("answer").focus()});
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Humans should colonize Mars - Graph View</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        /* Inline critical styles (graph.css will be external for customization) */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #e8eef5 100%);
            overflow: hidden;
        }

        #header {
            background: white;
            border-bottom: 1px solid #a2a9b1;
            padding: 15px 20px;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            height: 70px;
        }

        #header h1 {
            font-size: 1.3em;
            font-weight: 400;
            color: #202122;
            margin-bottom: 5px;
        }

        #header .meta {
            font-size: 0.85em;
            color: #72777d;
        }

        #controls {
            position: fixed;
            top: 80px;
            left: 10px;
            background: white;
            border: 1px solid #a2a9b1;
            border-radius: 4px;
            padding: 15px;
            z-index: 100;
            max-width: 250px;
        }

        #controls h3 {
            font-size: 0.9em;
            font-weight: 600;
            margin-bottom: 10px;
            color: #202122;
        }

        #controls input[type="text"] {
            width: 100%;
            padding: 6px 10px;
            border: 1px solid #a2a9b1;
            border-radius: 3px;
            font-size: 0.9em;
            margin-bottom: 10px;
        }

        #controls button {
            width: 100%;
            padding: 6px 10px;
            margin-bottom: 5px;
            border: 1px solid #a2a9b1;
            background: white;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.85em;
        }

        #controls button:hover {
            background: #eaecf0;
        }

        #legend {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #eaecf0;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-bottom: 5px;
        }

        .stat-item {
            background: #f8f9fa;
            padding: 8px;
            border-radius: 4px;
            border: 1px solid #eaecf0;
            border-left-width: 3px;
            border-left-color: #0645ad;
        }

        .stat-label {
            display: block;
            font-size: 0.7em;
            color: #72777d;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 3px;
        }

        .stat-number {
            display: block;
            font-size: 1.3em;
            font-weight: 600;
            color: #202122;
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
            font-size: 0.85em;
        }

        .legend-color {
            width: 24px;
            height: 24px;
            border-radius: 4px;
            margin-right: 10px;
            flex-shrink: 0;
        }

        #sidebar {
            position: fixed;
            top: 70px;
            right: -550px;
            width: 520px;
            height: calc(100vh - 70px);
            background: white;
            border-left: 2px solid #a2a9b1;
            transition: right 0.3s ease;
            z-index: 100;
            overflow-y: auto;
            padding: 0;
            box-shadow: -4px 0 12px rgba(0, 0, 0, 0.1);
        }

        #sidebar.open {
            right: 0;
        }

        #sidebar .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: #f8f9fa;
            border: 1px solid #a2a9b1;
            border-radius: 4px;
            width: 32px;
            height: 32px;
            font-size: 1.3em;
            cursor: pointer;
            color: #72777d;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            z-index: 10;
        }

        #sidebar .close-btn:hover {
            background: #eaecf0;
            color: #202122;
        }

        #sidebar-header {
            background: #f8f9fa;
            border-bottom: 1px solid #eaecf0;
            padding: 20px 25px;
            padding-right: 55px;
        }

        #sidebar-header h2 {
            font-size: 1.1em;
            font-weight: 600;
            margin-bottom: 8px;
            color: #202122;
        }

        .breadcrumb {
            font-size: 0.8em;
            color: #72777d;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 5px;
        }

        .breadcrumb-item {
            cursor: pointer;
            transition: color 0.2s;
        }

        .breadcrumb-item:hover {
            color: #0645ad;
            text-decoration: underline;
        }

        .breadcrumb-separator {
            color: #a2a9b1;
            margin: 0 3px;
        }

        #sidebar-body {
            padding: 20px 25px;
        }

        .section {
            margin-bottom: 25px;
        }

        .section-title {
            font-size: 0.9em;
            font-weight: 600;
            color: #72777d;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .node-text {
            font-size: 0.95em;
            line-height: 1.7;
            color: #202122;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            border-left: 4px solid #0645ad;
        }

        .node-badge-large {
            display: inline-block;
            font-size: 0.75em;
            padding: 4px 10px;
            border-radius: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-right: 8px;
        }

        .node-badge-large.pro {
            background: #d5f0e8;
            color: #2d9e7e;
            border: 1px solid #2d9e7e;
        }

        .node-badge-large.con {
            background: #f7e0e0;
            color: #c74848;
            border: 1px solid #c74848;
        }

        .node-badge-large.objection {
            background: #ffecd9;
            color: #d97a30;
            border: 1px solid #d97a30;
        }

        .node-badge-large.response {
            background: #e3eef8;
            color: #4a7fb8;
            border: 1px solid #4a7fb8;
        }

        .meta-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-top: 10px;
        }

        .meta-item {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            border: 1px solid #eaecf0;
        }

        .meta-label {
            font-size: 0.75em;
            color: #72777d;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 4px;
        }

        .meta-value {
            font-size: 1em;
            font-weight: 600;
            color: #202122;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .action-btn {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #a2a9b1;
            background: white;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85em;
            font-weight: 500;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }

        .action-btn:hover {
            background: #f8f9fa;
            border-color: #0645ad;
            color: #0645ad;
        }

        .action-btn.primary {
            background: #0645ad;
            color: white;
            border-color: #0645ad;
        }

        .action-btn.primary:hover {
            background: #0051a0;
        }

        .child-node {
            background: white;
            border: 1px solid #eaecf0;
            border-radius: 4px;
            padding: 12px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.2s;
            border-left: 4px solid transparent;
        }

        .child-node:hover {
            border-color: #0645ad;
            border-left-color: #0645ad;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        }

        .child-node.pro {
            border-left-color: #2d9e7e;
        }

        .child-node.con {
            border-left-color: #c74848;
        }

        .child-node.objection {
            border-left-color: #d97a30;
        }

        .child-node.response {
            border-left-color: #4a7fb8;
        }

        .child-node-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 6px;
        }

        .child-node-badge {
            font-size: 0.7em;
            padding: 2px 8px;
            border-radius: 10px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .child-node-text {
            font-size: 0.9em;
            line-height: 1.5;
            color: #202122;
        }

        .references-list {
            list-style: none;
            padding: 0;
        }

        .references-list li {
            margin-bottom: 8px;
            padding-left: 20px;
            position: relative;
        }

        .references-list li:before {
            content: "üîó";
            position: absolute;
            left: 0;
        }

        .references-list a {
            color: #0645ad;
            text-decoration: none;
            font-size: 0.85em;
            word-break: break-all;
        }

        .references-list a:hover {
            text-decoration: underline;
        }

        .empty-state {
            text-align: center;
            padding: 30px 20px;
            color: #72777d;
            font-size: 0.9em;
        }

        .stats-row {
            display: flex;
            justify-content: space-around;
            margin-top: 15px;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 4px;
        }

        .stat-box {
            text-align: center;
        }

        .stat-box-value {
            font-size: 1.4em;
            font-weight: 600;
            color: #0645ad;
        }

        .stat-box-label {
            font-size: 0.75em;
            color: #72777d;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-top: 2px;
        }

        #graph-container {
            position: fixed;
            top: 70px;
            left: 0;
            right: 0;
            bottom: 0;
        }

        svg {
            width: 100%;
            height: 100%;
        }

        .node {
            cursor: pointer;
        }

        .node circle {
            stroke: none;
            fill: transparent;
            opacity: 0;
            /* Keep circles for physics/collision detection but hide them */
        }

        /* Highlighted and selected states now apply to text boxes */
        .node.highlighted .node-text-content {
            outline: 3px solid #ffd700;
            outline-offset: 2px;
        }

        .node.selected .node-text-content {
            outline: 3px solid #0645ad;
            outline-offset: 2px;
        }

        /* foreignObject for text wrapping */
        .node foreignObject {
            overflow: visible;
            pointer-events: auto;  /* Make text boxes clickable */
        }

        .node-label {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            pointer-events: auto;  /* Make labels clickable */
        }

        .node-badge {
            font-size: 9px;
            padding: 2px 6px;
            border-radius: 3px;
            margin-bottom: 3px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(0, 0, 0, 0.2);
        }

        .node-badge.pro {
            color: #2d9e7e;
            border-color: #2d9e7e;
        }

        .node-badge.con {
            color: #c74848;
            border-color: #c74848;
        }

        .node-badge.objection {
            color: #d97a30;
            border-color: #d97a30;
        }

        .node-badge.response {
            color: #4a7fb8;
            border-color: #4a7fb8;
        }

        .node-text-content {
            color: #202122;
            line-height: 1.4;
            word-wrap: break-word;
            background: rgba(255, 255, 255, 0.95);
            padding: 6px 10px;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(0, 0, 0, 0.08);
            border-left-width: 3px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        /* Color-coded left borders by node type */
        .node.pro .node-text-content {
            border-left-color: #2d9e7e;
            background: rgba(213, 240, 232, 0.85);
        }

        .node.con .node-text-content {
            border-left-color: #c74848;
            background: rgba(247, 224, 224, 0.85);
        }

        .node.objection .node-text-content {
            border-left-color: #d97a30;
            background: rgba(255, 236, 217, 0.85);
        }

        .node.response .node-text-content {
            border-left-color: #4a7fb8;
            background: rgba(227, 238, 248, 0.85);
        }

        /* Depth-based opacity for hierarchy */
        .node.depth-0 .node-text-content {
            opacity: 1;
        }

        .node.depth-1 .node-text-content {
            opacity: 0.95;
        }

        .node.depth-2 .node-text-content {
            opacity: 0.9;
        }

        .node.depth-3 .node-text-content {
            opacity: 0.85;
        }

        .node.depth-4 .node-text-content {
            opacity: 0.8;
        }

        .node.depth-5 .node-text-content {
            opacity: 0.75;
        }

        /* Meta node text gets special styling */
        .node.meta-pro .node-text-content,
        .node.meta-con .node-text-content {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 12px 16px;
            font-weight: 700;
            font-size: 18px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            border-left-width: 5px;
        }

        .node.meta-pro .node-text-content {
            background: rgba(213, 240, 232, 0.95);
            border-left-color: #2d9e7e;
        }

        .node.meta-con .node-text-content {
            background: rgba(247, 224, 224, 0.95);
            border-left-color: #c74848;
        }

        /* Subtle hover effects */
        .node:hover .node-text-content {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }

        .link:hover {
            stroke-opacity: 0.8 !important;
            stroke-width: 3px;
        }

        .node title {
            font-size: 14px;
        }

        .link {
            stroke: #8b95a5;
            stroke-opacity: 0.3;
            fill: none;
            transition: all 0.2s ease;
        }

        /* Unified link styling - all types use same neutral color for cleaner look */
        .link.pro,
        .link.con,
        .link.objection,
        .link.response {
            stroke: #8b95a5;
            stroke-opacity: 0.3;
        }
    </style>
</head>
<body>
    <div id="header">
        <h1>Humans should colonize Mars</h1>
        <div class="meta">
            4 arguments for ‚Ä¢ 4 arguments against ‚Ä¢
            50 total nodes ‚Ä¢ Max depth: 3 ‚Ä¢
            Version 4
        </div>
    </div>

    <div id="controls">
        <a href="../debates/humans-should-colonize-mars.html" style="display: block; width: 100%; padding: 8px 10px; margin-bottom: 10px; text-align: center; background: #0645ad; color: white; border-radius: 3px; text-decoration: none; font-size: 0.85em; font-weight: 500;">üìñ View Debate Page</a>

        <h3>üîç Search & Navigate</h3>
        <input type="text" id="search" placeholder="Search arguments...">
        <button onclick="resetAndFit()">üéØ Reset & Fit View</button>

        <div id="legend">
            <h3>üìä Tree Statistics</h3>
            <div class="stats-grid">
                <div class="stat-item">
                    <span class="stat-label">Total Nodes</span>
                    <span class="stat-number">50</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Max Depth</span>
                    <span class="stat-number">3</span>
                </div>
                <div class="stat-item" style="border-left: 3px solid #2d9e7e;">
                    <span class="stat-label">Supporting</span>
                    <span class="stat-number" style="color: #2d9e7e;">4</span>
                </div>
                <div class="stat-item" style="border-left: 3px solid #c74848;">
                    <span class="stat-label">Opposing</span>
                    <span class="stat-number" style="color: #c74848;">4</span>
                </div>
            </div>

            <h3 style="margin-top: 15px;">üé® Argument Types</h3>
            <div class="legend-item">
                <div class="legend-color" style="background: rgba(213, 240, 232, 0.85); border: 2px solid #2d9e7e;"></div>
                <span>Pro / Supporting</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: rgba(247, 224, 224, 0.85); border: 2px solid #c74848;"></div>
                <span>Con / Opposing</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: rgba(255, 236, 217, 0.85); border: 2px solid #d97a30;"></div>
                <span>Objection</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: rgba(227, 238, 248, 0.85); border: 2px solid #4a7fb8;"></div>
                <span>Response</span>
            </div>
        </div>
    </div>

    <div id="sidebar">
        <button class="close-btn" onclick="closeSidebar()">√ó</button>
        <div id="sidebar-header"></div>
        <div id="sidebar-body"></div>
    </div>

    <div id="graph-container">
        <svg id="graph"></svg>
    </div>

    <script>
        // Graph data from Python
        const graphData = {
  "nodes": [
    {
      "id": "6077d94e-c323-4d5c-9694-7e08cbf1d678",
      "text": "Establishing a permanent, self-sustaining human presence on Mars diversifies humanity's habitat, mitigating the existential risk of extinction caused by single-planet catastrophes (e.g., massive asteroid impacts, global pandemics, or supervolcanoes).",
      "type": "pro",
      "side": "pro",
      "depth": 0,
      "parent_id": "meta-pro",
      "children_count": 1,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:14:39.085767"
    },
    {
      "id": "86f58d0f-5550-4c59-983f-0d1f9c996bed",
      "text": "The technological challenges inherent in establishing a Martian colony act as a powerful catalyst for innovation in fields like sustainable energy, advanced manufacturing, and closed-loop life support, mirroring the historical spin-offs from the Apollo program.",
      "type": "pro",
      "side": "pro",
      "depth": 0,
      "parent_id": "meta-pro",
      "children_count": 1,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:14:39.086676"
    },
    {
      "id": "cd32f259-a531-44a3-b2f7-21eef206a349",
      "text": "Colonization leverages extraterrestrial resources, such as Martian water ice, to create essential propellant and materials in-situ, significantly reducing logistical costs and enabling sustainable off-world economic expansion.",
      "type": "pro",
      "side": "pro",
      "depth": 0,
      "parent_id": "meta-pro",
      "children_count": 2,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:14:39.087190"
    },
    {
      "id": "c438c5d8-3de5-400b-b4aa-f23ccd60dc2e",
      "text": "A Mars colony provides continuous, high-bandwidth access for large-scale scientific investigation into Martian geology, climate history, and the potential existence of past or present microbial life, addressing fundamental questions about planetary formation and biology.",
      "type": "pro",
      "side": "pro",
      "depth": 0,
      "parent_id": "meta-pro",
      "children_count": 2,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:14:39.087621"
    },
    {
      "id": "f4f172f6-6043-4199-8c76-950d381f14ae",
      "text": "Apollo-era R&D was publicly funded with a mandate for open knowledge transfer, ensuring widespread spin-offs. Modern private space ventures, however, protect innovations developed for Martian colonization as proprietary intellectual property, severely restricting the general economic and societal diffusion necessary for \"spin-offs.\"",
      "type": "objection",
      "side": "con",
      "depth": 1,
      "parent_id": "86f58d0f-5550-4c59-983f-0d1f9c996bed",
      "children_count": 2,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:14:50.386649"
    },
    {
      "id": "06f691f6-f373-416c-aea5-e4264dbb563a",
      "text": "During its initial centuries, a Martian colony would remain technologically dependent on Earth for critical high-tech manufacturing, pharmaceuticals, and specialized knowledge. If an extinction event occurs on Earth before the colony achieves true independence, the sudden cutoff of support will cause the fragile off-world settlement to fail, neutralizing the intended risk mitigation.",
      "type": "objection",
      "side": "con",
      "depth": 1,
      "parent_id": "6077d94e-c323-4d5c-9694-7e08cbf1d678",
      "children_count": 1,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:14:50.606656"
    },
    {
      "id": "1a8825e6-0e94-4a5b-a532-10e6e1cd2b46",
      "text": "The initial, massive capital investment and operational costs for establishing extraterrestrial In-Situ Resource Utilization (ISRU) infrastructure (e.g., Martian water extraction) will negate any immediate or significant logistical cost savings for decades, preventing sustainable expansion based on prompt cost reduction.",
      "type": "objection",
      "side": "con",
      "depth": 1,
      "parent_id": "cd32f259-a531-44a3-b2f7-21eef206a349",
      "children_count": 2,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:14:50.617387"
    },
    {
      "id": "fb0c9d27-db95-4ca1-b0d7-b8f6efc4452b",
      "text": "Achieving logistical self-sufficiency by producing propellant does not automatically guarantee \"economic expansion,\" which requires establishing a viable market demand for exported goods and a self-sustaining local economy for labor and non-propellant material manufacturing.",
      "type": "objection",
      "side": "con",
      "depth": 1,
      "parent_id": "cd32f259-a531-44a3-b2f7-21eef206a349",
      "children_count": 0,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:14:50.618041"
    },
    {
      "id": "f1a983c8-2bf5-4463-ad38-edf124b342de",
      "text": "High-volume data transmission from Mars is fundamentally limited by the inverse square law and power consumption requirements, making reliable, continuous bandwidth technologically impractical for a nascent colony.",
      "type": "objection",
      "side": "con",
      "depth": 1,
      "parent_id": "c438c5d8-3de5-400b-b4aa-f23ccd60dc2e",
      "children_count": 1,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:14:50.785306"
    },
    {
      "id": "1c7d0d16-93ae-4b25-b53b-a0114cf0c5ab",
      "text": "Establishing a full, self-sufficient colony is not a prerequisite for large-scale investigation; advanced robotic missions or smaller, temporary human outposts can achieve core scientific goals like sample collection and analysis more cost-effectively.",
      "type": "objection",
      "side": "con",
      "depth": 1,
      "parent_id": "c438c5d8-3de5-400b-b4aa-f23ccd60dc2e",
      "children_count": 2,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:14:50.786126"
    },
    {
      "id": "a37b420b-10d1-4d01-8e44-890a9c892c7e",
      "text": "The logistical cost savings accrue immediately by reducing the most expensive factor\u2014launching propellant mass from Earth (currently $2,000\u2013$20,000/kg). Even small-scale ISRU significantly shrinks the recurring mission costs, accelerating the financial break-even point to within a few key missions, not necessarily decades.",
      "type": "response",
      "side": "pro",
      "depth": 2,
      "parent_id": "1a8825e6-0e94-4a5b-a532-10e6e1cd2b46",
      "children_count": 0,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:00.800151"
    },
    {
      "id": "8b749faf-c883-435c-ad1d-1076038656db",
      "text": "Sustainable expansion in space exploration is fundamentally driven by strategic resilience and logistical scaling limits, not solely immediate financial cost reduction. The initial CapEx is a strategic, non-negotiable prerequisite necessary to break the single point of failure inherent in relying only on Earth-supplied resources for long-term off-world permanence.",
      "type": "response",
      "side": "pro",
      "depth": 2,
      "parent_id": "1a8825e6-0e94-4a5b-a532-10e6e1cd2b46",
      "children_count": 0,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:00.800896"
    },
    {
      "id": "163b9980-ce9a-462c-942f-3f40287a79c3",
      "text": "While advanced robotics can manage simple sample collection, complex, multi-decade projects like developing self-sustaining In-Situ Resource Utilization (ISRU) infrastructure and deep geological monitoring require the adaptability and continuous labor of a permanent human colony.",
      "type": "response",
      "side": "pro",
      "depth": 2,
      "parent_id": "1c7d0d16-93ae-4b25-b53b-a0114cf0c5ab",
      "children_count": 0,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:01.305395"
    },
    {
      "id": "21bb559e-c21c-4005-b25d-20d35cbd7a63",
      "text": "Self-sufficiency is the fundamental economic mechanism that shifts Martian exploration from a prohibitively expensive resupply dependency to a cost-effective, long-term venture via in-situ resource utilization.",
      "type": "response",
      "side": "pro",
      "depth": 2,
      "parent_id": "1c7d0d16-93ae-4b25-b53b-a0114cf0c5ab",
      "children_count": 0,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:01.305866"
    },
    {
      "id": "ccc7a32b-0229-416c-9dfe-4113735d2d83",
      "text": "Intellectual property drives diffusion in the private sector by enabling commercial licensing, venture capital investment, and the creation of specialized spin-off companies (like in the biotech sector), which accelerates rather than restricts market adoption.",
      "type": "response",
      "side": "pro",
      "depth": 2,
      "parent_id": "f4f172f6-6043-4199-8c76-950d381f14ae",
      "children_count": 2,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:01.922134"
    },
    {
      "id": "31462373-78d4-4d42-9014-f2e2b870e342",
      "text": "Apollo program R&D focused on foundational engineering with high existing terrestrial relevance (e.g., materials science, miniaturization), whereas technology developed primarily for Martian colonization has inherently niche and limited immediate economic applicability, regardless of IP status.",
      "type": "response",
      "side": "pro",
      "depth": 2,
      "parent_id": "f4f172f6-6043-4199-8c76-950d381f14ae",
      "children_count": 0,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:01.922681"
    },
    {
      "id": "de011e34-3723-4e95-b962-f84495d1e3af",
      "text": "A colony established specifically for existential risk mitigation would mandate massive, multi-century stockpiling of critical infrastructure, pharmaceuticals, and digitized scientific knowledge. This planned redundancy ensures the ability to sustain a closed-loop, viable population through supply cutoff, even if this requires reverting to a lower technological standard.",
      "type": "response",
      "side": "pro",
      "depth": 2,
      "parent_id": "06f691f6-f373-416c-aea5-e4264dbb563a",
      "children_count": 0,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:02.981914"
    },
    {
      "id": "70555b12-d4f9-40a5-86ba-b6026b042c21",
      "text": "NASA's Laser Communications Relay Demonstration (LCRD) and related deep-space optical terminals already demonstrate reliable, high-volume data transmission across vast distances using dedicated laser relays.",
      "type": "response",
      "side": "pro",
      "depth": 2,
      "parent_id": "f1a983c8-2bf5-4463-ad38-edf124b342de",
      "children_count": 0,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:04.597070"
    },
    {
      "id": "a9858026-573e-4dd8-be91-a7f3c2df4849",
      "text": "Patent thickets and defensive patenting, particularly common in consumer electronics and software industries, introduce high transaction costs and legal uncertainty that actively restrict market entry and slow down the diffusion of technologies across numerous sectors.",
      "type": "response",
      "side": "con",
      "depth": 3,
      "parent_id": "ccc7a32b-0229-416c-9dfe-4113735d2d83",
      "children_count": 0,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:19.391261"
    },
    {
      "id": "ad86e238-b4d3-43e2-b3d0-e1b14beee407",
      "text": "Monopolistic IP control over critical goods, such as vaccine recipes during the COVID-19 pandemic, significantly restricted rapid global manufacturing scale-up, demonstrating that restrictions frequently outweigh accelerated diffusion when profit motives clash with urgent need.",
      "type": "response",
      "side": "con",
      "depth": 3,
      "parent_id": "ccc7a32b-0229-416c-9dfe-4113735d2d83",
      "children_count": 0,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:19.391327"
    },
    {
      "id": "64e2a03d-10c3-4ee0-983d-e965e87bf426",
      "text": "Investing projected colonization funds in climate change mitigation and global health offers a higher and more immediate return, as these terrestrial interventions provide measurable, certain welfare gains, unlike the hypothetical, distant benefits of planetary expansion.",
      "type": "con",
      "side": "con",
      "depth": 0,
      "parent_id": "meta-con",
      "children_count": 2,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:19.391586"
    },
    {
      "id": "5a6be43b-0914-458e-981b-1b0936e98486",
      "text": "Creating a self-sustaining closed-loop ecosystem capable of supporting human life for generations remains technologically unproven, even in controlled terrestrial environments like the Biosphere 2 experiment. Extrapolating the repeatable failures and necessary external resupply of the International Space Station to the extreme isolation of Mars highlights an unacceptable and prolonged risk of mass mortality.",
      "type": "con",
      "side": "con",
      "depth": 0,
      "parent_id": "meta-con",
      "children_count": 2,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:19.392947"
    },
    {
      "id": "4d951838-d15f-4995-95a9-cfbc47ed3c33",
      "text": "Human colonization would violate established planetary protection guidelines, irreversibly contaminating the Martian environment with terrestrial microbes. This action would destroy the chance to definitively search for and study indigenous Martian life, sacrificing a unique, non-renewable scientific opportunity for all future generations.",
      "type": "con",
      "side": "con",
      "depth": 0,
      "parent_id": "meta-con",
      "children_count": 2,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:19.393736"
    },
    {
      "id": "8252e196-e572-4453-a7f7-7237558fec11",
      "text": "Any initial Martian colony would remain technologically and logistically dependent on a complex Earth-based supply chain for decades, similar to remote facilities like Antarctica\u2019s largest research stations. Framing colonization as an \"insurance policy\" against terrestrial catastrophe is misleading, as a major global collapse would simultaneously sever the necessary technological lifeline, dooming the isolated Mars outpost.",
      "type": "con",
      "side": "con",
      "depth": 0,
      "parent_id": "meta-con",
      "children_count": 2,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:19.394088"
    },
    {
      "id": "1d084b1b-228e-41ce-b094-e887c258865b",
      "text": "Eliminating the Mars project would primarily redirect specialized private R&D capital back into general private markets, not into public sector budgets for climate or health initiatives.",
      "type": "objection",
      "side": "pro",
      "depth": 1,
      "parent_id": "64e2a03d-10c3-4ee0-983d-e965e87bf426",
      "children_count": 0,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:30.401368"
    },
    {
      "id": "687498ba-04ec-496a-a146-10c129a7b0e7",
      "text": "The evaluation of \"higher impact\" neglects the long-term, high-leverage benefits of achieving planetary redundancy, which mitigates existential risk and provides a permanent safeguard for human civilization, outweighing immediate, incremental terrestrial gains.",
      "type": "objection",
      "side": "pro",
      "depth": 1,
      "parent_id": "64e2a03d-10c3-4ee0-983d-e965e87bf426",
      "children_count": 2,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:30.402118"
    },
    {
      "id": "ef9919b8-98bf-435a-b7ca-13560b682719",
      "text": "The scientific opportunity is not sacrificed by contamination; modern deep sequencing and genomic analysis tools can reliably distinguish potential indigenous Martian biosignatures from terrestrial microbes.",
      "type": "objection",
      "side": "pro",
      "depth": 1,
      "parent_id": "4d951838-d15f-4995-95a9-cfbc47ed3c33",
      "children_count": 2,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:32.127619"
    },
    {
      "id": "c782206b-4dc3-4cda-8920-22f2947d6b7c",
      "text": "Finding and studying extant Martian life, likely deep subterranean, requires sustained access to resource-intensive drilling and large-scale laboratories. Scientific missions lacking permanent settlements cannot practically provide the necessary infrastructure for deep, multi-year subsurface exploration.",
      "type": "objection",
      "side": "pro",
      "depth": 1,
      "parent_id": "4d951838-d15f-4995-95a9-cfbc47ed3c33",
      "children_count": 2,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:32.128181"
    },
    {
      "id": "73c7817b-eadf-42e4-8a1d-fe1d92c8315d",
      "text": "Regional catastrophes, such as a multi-continent nuclear exchange or a localized hyper-climate collapse, justify Mars as an insurance policy because sufficient multinational high-tech infrastructure would survive outside the disaster zone to provide minimal logistical support.",
      "type": "objection",
      "side": "pro",
      "depth": 1,
      "parent_id": "8252e196-e572-4453-a7f7-7237558fec11",
      "children_count": 2,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:33.145620"
    },
    {
      "id": "32900cec-d335-4800-96db-0fbb72f6eb44",
      "text": "The concept of an \"insurance policy\" is misrepresented; its value is in shifting long-term risk by accelerating the colony's timeline toward self-sufficiency before the predicted catastrophic event, not guaranteeing immediate redundancy upon founding.",
      "type": "objection",
      "side": "pro",
      "depth": 1,
      "parent_id": "8252e196-e572-4453-a7f7-7237558fec11",
      "children_count": 2,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:33.146074"
    },
    {
      "id": "31c338b7-e3a4-4315-8fec-95686bd67069",
      "text": "Modern regenerative Environmental Control and Life Support Systems (ECLSS) already achieve 98% water recovery and high oxygen recovery on the ISS, making the comparison to the passive and materially flawed 1990s Biosphere 2 ecologically irrelevant for future Mars habitat design.",
      "type": "objection",
      "side": "pro",
      "depth": 1,
      "parent_id": "5a6be43b-0914-458e-981b-1b0936e98486",
      "children_count": 2,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:37.956261"
    },
    {
      "id": "b6c896a0-2d98-4d0a-8937-1e732be91e86",
      "text": "Historical colonization efforts, such as the initial Jamestown colony in 1607, faced actual mortality rates exceeding 70% within the first two years, demonstrating that societies have historically accepted extremely high, prolonged risks for pioneering endeavors.",
      "type": "objection",
      "side": "pro",
      "depth": 1,
      "parent_id": "5a6be43b-0914-458e-981b-1b0936e98486",
      "children_count": 2,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:37.957075"
    },
    {
      "id": "5c5407b8-a675-4352-bafb-3f585542188e",
      "text": "Planetary redundancy is a speculative future goal with an unknown probability of success, making its current expected value impossible to assess and rationally weigh against concrete, measurable gains like immediate poverty reduction or global disease eradication.",
      "type": "response",
      "side": "con",
      "depth": 2,
      "parent_id": "687498ba-04ec-496a-a146-10c129a7b0e7",
      "children_count": 2,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:42.360107"
    },
    {
      "id": "381310cd-6539-476a-b746-bdd95e1d6218",
      "text": "Immediate, high-leverage existential risk mitigation requires strengthening terrestrial biosecurity and deploying rapid climate action, which address the highest probability threats decades before a sustainable Mars colony could provide true planetary redundancy.",
      "type": "response",
      "side": "con",
      "depth": 2,
      "parent_id": "687498ba-04ec-496a-a146-10c129a7b0e7",
      "children_count": 0,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:42.360899"
    },
    {
      "id": "d4e3779d-b162-49b4-8b87-ef0efe08ca6c",
      "text": "Extant life may exist in near-surface brines or transient liquid water formations, requiring sophisticated, but significantly less resource-intensive missions (e.g., small-scale robotic drilling) than kilometer-scale deep subsurface exploration.",
      "type": "response",
      "side": "con",
      "depth": 2,
      "parent_id": "c782206b-4dc3-4cda-8920-22f2947d6b7c",
      "children_count": 0,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:42.388084"
    },
    {
      "id": "2c99662a-b6f8-43b9-8da0-d79defc6f48e",
      "text": "Large-scale, autonomous robotic bases powered by nuclear or solar arrays (like terrestrial deep-sea drilling rigs) are increasingly capable of performing multi-year, deep subsurface drilling and analysis without requiring a permanent human settlement.",
      "type": "response",
      "side": "con",
      "depth": 2,
      "parent_id": "c782206b-4dc3-4cda-8920-22f2947d6b7c",
      "children_count": 0,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:42.388502"
    },
    {
      "id": "7d1063a9-db4e-4395-ad29-29c8b3f46e4f",
      "text": "A regional nuclear exchange or severe climate catastrophe would destabilize the specialized global supply chains, economic resources, and multinational political cooperation necessary to successfully maintain high-tech support for a Mars colony.",
      "type": "response",
      "side": "con",
      "depth": 2,
      "parent_id": "73c7817b-eadf-42e4-8a1d-fe1d92c8315d",
      "children_count": 0,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:43.089309"
    },
    {
      "id": "8745e0c2-d2af-4024-b94a-e4e653a4c7b4",
      "text": "For regional catastrophes, relocating populations to vast, undamaged, or recoverable safe zones within Earth is significantly less resource-intensive and technically challenging than establishing and supplying an interplanetary safe haven on Mars.",
      "type": "response",
      "side": "con",
      "depth": 2,
      "parent_id": "73c7817b-eadf-42e4-8a1d-fe1d92c8315d",
      "children_count": 0,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:43.089775"
    },
    {
      "id": "1355e108-9737-44b6-bb14-e7e1804c2888",
      "text": "Current deep sequencing is optimized exclusively for terrestrial DNA/RNA. If Martian life employs a non-nucleic acid polymer or exhibits a different chirality (e.g., L-amino acids), the assumed genomic tools would not recognize, filter, or analyze the unique extraterrestrial life signature.",
      "type": "response",
      "side": "con",
      "depth": 2,
      "parent_id": "ef9919b8-98bf-435a-b7ca-13560b682719",
      "children_count": 0,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:43.426709"
    },
    {
      "id": "f7dd30f4-0bf2-4804-bcad-cc875aeb5b80",
      "text": "Distinguishing an *unknown* Martian signature existing in trace amounts from an overwhelming, diverse terrestrial contaminant background (e.g., vast human microbiome from spacecraft) remains an unproven, theoretical computational challenge, as reliable filtering requires a known or validated model of the target genome.",
      "type": "response",
      "side": "con",
      "depth": 2,
      "parent_id": "ef9919b8-98bf-435a-b7ca-13560b682719",
      "children_count": 0,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:43.427496"
    },
    {
      "id": "fabd19db-b631-4016-87bd-14ee8c0a4bc0",
      "text": "Acceleration alone does not guarantee a transition to sustainability; a rapidly established colony might still collapse if critical resources become unavailable or unexpected engineering challenges arise, failing to actually shift the fundamental long-term risk.",
      "type": "response",
      "side": "con",
      "depth": 2,
      "parent_id": "32900cec-d335-4800-96db-0fbb72f6eb44",
      "children_count": 0,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:43.435754"
    },
    {
      "id": "8a50634f-1f2f-47c9-86d7-c09629c7cca9",
      "text": "Conventional insurance policies derive value from financial payout or immediate restorative capacity upon loss, not speculative timeline acceleration; this redefinition ignores the necessary requirement for immediate system redundancy upon catastrophic failure.",
      "type": "response",
      "side": "con",
      "depth": 2,
      "parent_id": "32900cec-d335-4800-96db-0fbb72f6eb44",
      "children_count": 2,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:43.436483"
    },
    {
      "id": "2283ecbc-a34d-4206-82af-b0433d63c3f9",
      "text": "The extreme risk cited resulted primarily from logistical failures, poor site selection, starvation, and disease\u2014avoidable risks of mismanagement\u2014not the inherent or necessary technical risks characteristic of true \"pioneering endeavors.\"",
      "type": "response",
      "side": "con",
      "depth": 2,
      "parent_id": "b6c896a0-2d98-4d0a-8937-1e732be91e86",
      "children_count": 0,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:49.747367"
    },
    {
      "id": "690f43c2-9a94-4a3a-9843-ea5bd0d3a1d2",
      "text": "These high mortality rates were often concealed or minimized by venture promoters and investors to maintain recruitment and financing, meaning the risk was borne by uninformed individuals, not collectively accepted or justified by the broader sponsoring society.",
      "type": "response",
      "side": "con",
      "depth": 2,
      "parent_id": "b6c896a0-2d98-4d0a-8937-1e732be91e86",
      "children_count": 0,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:49.747952"
    },
    {
      "id": "bad06c10-5db2-4c0c-8949-78ace3c872b4",
      "text": "The ISS is an open system that relies on continuous resupply of food and replacement mechanical components, whereas a true Mars habitat requires a fully closed ecological loop, meaning B2's data on managing system closure remains crucial.",
      "type": "response",
      "side": "con",
      "depth": 2,
      "parent_id": "31c338b7-e3a4-4315-8fec-95686bd67069",
      "children_count": 0,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:52.012333"
    },
    {
      "id": "88a49f61-ed37-4dd0-93a2-44d971420a2a",
      "text": "Regenerative ECLSS addresses elemental recycling using active mechanical systems but ignores the critical long-term biological stability and non-equilibrium ecological dynamics that were the central failures of Biosphere 2.",
      "type": "response",
      "side": "con",
      "depth": 2,
      "parent_id": "31c338b7-e3a4-4315-8fec-95686bd67069",
      "children_count": 0,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:52.012785"
    },
    {
      "id": "7b09fd3f-cb6f-4c5a-9a33-99cabcd8b0ff",
      "text": "Assessment of high-impact, low-probability events, like existential risk mitigation through planetary redundancy, is routinely conducted using subjective probability assignments (epistemic confidence) and scenario modeling, meaning assessment is difficult but not impossible.",
      "type": "response",
      "side": "pro",
      "depth": 3,
      "parent_id": "5c5407b8-a675-4352-bafb-3f585542188e",
      "children_count": 0,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:53.235298"
    },
    {
      "id": "1e1f1b34-72da-4a75-a30b-459c26005f0e",
      "text": "Most initiatives aiming for Martian colonization are financed by private entrepreneurs whose capital is distinct from state budgets allocated for poverty reduction or global health programs.",
      "type": "response",
      "side": "pro",
      "depth": 3,
      "parent_id": "5c5407b8-a675-4352-bafb-3f585542188e",
      "children_count": 0,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:53.235322"
    },
    {
      "id": "bb81853b-7d38-433c-95b6-93aa6d347328",
      "text": "Establishing self-sustaining colonies requires resource commitments that historically fail to materialize past initial speculative phases, similar to the rapidly changing government priorities that led to the termination of the Apollo moon landing follow-up plans and NASA's Constellation program.",
      "type": "response",
      "side": "pro",
      "depth": 3,
      "parent_id": "8a50634f-1f2f-47c9-86d7-c09629c7cca9",
      "children_count": 0,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:55.617730"
    },
    {
      "id": "7d726367-5ff0-4e76-9672-186faa6d5a2b",
      "text": "Long-term, closed-loop Martian life support systems have never demonstrated viability, as shown by the Biosphere 2 experiment which failed to maintain oxygen stability and required external intervention, illustrating an inherent inability to guarantee system redundancy.",
      "type": "response",
      "side": "pro",
      "depth": 3,
      "parent_id": "8a50634f-1f2f-47c9-86d7-c09629c7cca9",
      "children_count": 0,
      "references": [],
      "source": "ai-generated",
      "created_at": "2025-10-11T00:15:55.617771"
    },
    {
      "id": "meta-pro",
      "text": "Arguments For",
      "type": "meta-pro",
      "side": "pro",
      "depth": -1,
      "parent_id": null,
      "children_count": 4,
      "references": [],
      "source": "system",
      "created_at": "2025-10-11T00:14:39.085681"
    },
    {
      "id": "meta-con",
      "text": "Arguments Against",
      "type": "meta-con",
      "side": "con",
      "depth": -1,
      "parent_id": null,
      "children_count": 4,
      "references": [],
      "source": "system",
      "created_at": "2025-10-11T00:14:39.085681"
    }
  ],
  "links": [
    {
      "source": "86f58d0f-5550-4c59-983f-0d1f9c996bed",
      "target": "f4f172f6-6043-4199-8c76-950d381f14ae",
      "type": "objection"
    },
    {
      "source": "6077d94e-c323-4d5c-9694-7e08cbf1d678",
      "target": "06f691f6-f373-416c-aea5-e4264dbb563a",
      "type": "objection"
    },
    {
      "source": "cd32f259-a531-44a3-b2f7-21eef206a349",
      "target": "1a8825e6-0e94-4a5b-a532-10e6e1cd2b46",
      "type": "objection"
    },
    {
      "source": "cd32f259-a531-44a3-b2f7-21eef206a349",
      "target": "fb0c9d27-db95-4ca1-b0d7-b8f6efc4452b",
      "type": "objection"
    },
    {
      "source": "c438c5d8-3de5-400b-b4aa-f23ccd60dc2e",
      "target": "f1a983c8-2bf5-4463-ad38-edf124b342de",
      "type": "objection"
    },
    {
      "source": "c438c5d8-3de5-400b-b4aa-f23ccd60dc2e",
      "target": "1c7d0d16-93ae-4b25-b53b-a0114cf0c5ab",
      "type": "objection"
    },
    {
      "source": "1a8825e6-0e94-4a5b-a532-10e6e1cd2b46",
      "target": "a37b420b-10d1-4d01-8e44-890a9c892c7e",
      "type": "response"
    },
    {
      "source": "1a8825e6-0e94-4a5b-a532-10e6e1cd2b46",
      "target": "8b749faf-c883-435c-ad1d-1076038656db",
      "type": "response"
    },
    {
      "source": "1c7d0d16-93ae-4b25-b53b-a0114cf0c5ab",
      "target": "163b9980-ce9a-462c-942f-3f40287a79c3",
      "type": "response"
    },
    {
      "source": "1c7d0d16-93ae-4b25-b53b-a0114cf0c5ab",
      "target": "21bb559e-c21c-4005-b25d-20d35cbd7a63",
      "type": "response"
    },
    {
      "source": "f4f172f6-6043-4199-8c76-950d381f14ae",
      "target": "ccc7a32b-0229-416c-9dfe-4113735d2d83",
      "type": "response"
    },
    {
      "source": "f4f172f6-6043-4199-8c76-950d381f14ae",
      "target": "31462373-78d4-4d42-9014-f2e2b870e342",
      "type": "response"
    },
    {
      "source": "06f691f6-f373-416c-aea5-e4264dbb563a",
      "target": "de011e34-3723-4e95-b962-f84495d1e3af",
      "type": "response"
    },
    {
      "source": "f1a983c8-2bf5-4463-ad38-edf124b342de",
      "target": "70555b12-d4f9-40a5-86ba-b6026b042c21",
      "type": "response"
    },
    {
      "source": "ccc7a32b-0229-416c-9dfe-4113735d2d83",
      "target": "a9858026-573e-4dd8-be91-a7f3c2df4849",
      "type": "response"
    },
    {
      "source": "ccc7a32b-0229-416c-9dfe-4113735d2d83",
      "target": "ad86e238-b4d3-43e2-b3d0-e1b14beee407",
      "type": "response"
    },
    {
      "source": "64e2a03d-10c3-4ee0-983d-e965e87bf426",
      "target": "1d084b1b-228e-41ce-b094-e887c258865b",
      "type": "objection"
    },
    {
      "source": "64e2a03d-10c3-4ee0-983d-e965e87bf426",
      "target": "687498ba-04ec-496a-a146-10c129a7b0e7",
      "type": "objection"
    },
    {
      "source": "4d951838-d15f-4995-95a9-cfbc47ed3c33",
      "target": "ef9919b8-98bf-435a-b7ca-13560b682719",
      "type": "objection"
    },
    {
      "source": "4d951838-d15f-4995-95a9-cfbc47ed3c33",
      "target": "c782206b-4dc3-4cda-8920-22f2947d6b7c",
      "type": "objection"
    },
    {
      "source": "8252e196-e572-4453-a7f7-7237558fec11",
      "target": "73c7817b-eadf-42e4-8a1d-fe1d92c8315d",
      "type": "objection"
    },
    {
      "source": "8252e196-e572-4453-a7f7-7237558fec11",
      "target": "32900cec-d335-4800-96db-0fbb72f6eb44",
      "type": "objection"
    },
    {
      "source": "5a6be43b-0914-458e-981b-1b0936e98486",
      "target": "31c338b7-e3a4-4315-8fec-95686bd67069",
      "type": "objection"
    },
    {
      "source": "5a6be43b-0914-458e-981b-1b0936e98486",
      "target": "b6c896a0-2d98-4d0a-8937-1e732be91e86",
      "type": "objection"
    },
    {
      "source": "687498ba-04ec-496a-a146-10c129a7b0e7",
      "target": "5c5407b8-a675-4352-bafb-3f585542188e",
      "type": "response"
    },
    {
      "source": "687498ba-04ec-496a-a146-10c129a7b0e7",
      "target": "381310cd-6539-476a-b746-bdd95e1d6218",
      "type": "response"
    },
    {
      "source": "c782206b-4dc3-4cda-8920-22f2947d6b7c",
      "target": "d4e3779d-b162-49b4-8b87-ef0efe08ca6c",
      "type": "response"
    },
    {
      "source": "c782206b-4dc3-4cda-8920-22f2947d6b7c",
      "target": "2c99662a-b6f8-43b9-8da0-d79defc6f48e",
      "type": "response"
    },
    {
      "source": "73c7817b-eadf-42e4-8a1d-fe1d92c8315d",
      "target": "7d1063a9-db4e-4395-ad29-29c8b3f46e4f",
      "type": "response"
    },
    {
      "source": "73c7817b-eadf-42e4-8a1d-fe1d92c8315d",
      "target": "8745e0c2-d2af-4024-b94a-e4e653a4c7b4",
      "type": "response"
    },
    {
      "source": "ef9919b8-98bf-435a-b7ca-13560b682719",
      "target": "1355e108-9737-44b6-bb14-e7e1804c2888",
      "type": "response"
    },
    {
      "source": "ef9919b8-98bf-435a-b7ca-13560b682719",
      "target": "f7dd30f4-0bf2-4804-bcad-cc875aeb5b80",
      "type": "response"
    },
    {
      "source": "32900cec-d335-4800-96db-0fbb72f6eb44",
      "target": "fabd19db-b631-4016-87bd-14ee8c0a4bc0",
      "type": "response"
    },
    {
      "source": "32900cec-d335-4800-96db-0fbb72f6eb44",
      "target": "8a50634f-1f2f-47c9-86d7-c09629c7cca9",
      "type": "response"
    },
    {
      "source": "b6c896a0-2d98-4d0a-8937-1e732be91e86",
      "target": "2283ecbc-a34d-4206-82af-b0433d63c3f9",
      "type": "response"
    },
    {
      "source": "b6c896a0-2d98-4d0a-8937-1e732be91e86",
      "target": "690f43c2-9a94-4a3a-9843-ea5bd0d3a1d2",
      "type": "response"
    },
    {
      "source": "31c338b7-e3a4-4315-8fec-95686bd67069",
      "target": "bad06c10-5db2-4c0c-8949-78ace3c872b4",
      "type": "response"
    },
    {
      "source": "31c338b7-e3a4-4315-8fec-95686bd67069",
      "target": "88a49f61-ed37-4dd0-93a2-44d971420a2a",
      "type": "response"
    },
    {
      "source": "5c5407b8-a675-4352-bafb-3f585542188e",
      "target": "7b09fd3f-cb6f-4c5a-9a33-99cabcd8b0ff",
      "type": "response"
    },
    {
      "source": "5c5407b8-a675-4352-bafb-3f585542188e",
      "target": "1e1f1b34-72da-4a75-a30b-459c26005f0e",
      "type": "response"
    },
    {
      "source": "8a50634f-1f2f-47c9-86d7-c09629c7cca9",
      "target": "bb81853b-7d38-433c-95b6-93aa6d347328",
      "type": "response"
    },
    {
      "source": "8a50634f-1f2f-47c9-86d7-c09629c7cca9",
      "target": "7d726367-5ff0-4e76-9672-186faa6d5a2b",
      "type": "response"
    },
    {
      "source": "meta-pro",
      "target": "6077d94e-c323-4d5c-9694-7e08cbf1d678",
      "type": "meta-link"
    },
    {
      "source": "meta-pro",
      "target": "86f58d0f-5550-4c59-983f-0d1f9c996bed",
      "type": "meta-link"
    },
    {
      "source": "meta-pro",
      "target": "cd32f259-a531-44a3-b2f7-21eef206a349",
      "type": "meta-link"
    },
    {
      "source": "meta-pro",
      "target": "c438c5d8-3de5-400b-b4aa-f23ccd60dc2e",
      "type": "meta-link"
    },
    {
      "source": "meta-con",
      "target": "64e2a03d-10c3-4ee0-983d-e965e87bf426",
      "type": "meta-link"
    },
    {
      "source": "meta-con",
      "target": "5a6be43b-0914-458e-981b-1b0936e98486",
      "type": "meta-link"
    },
    {
      "source": "meta-con",
      "target": "4d951838-d15f-4995-95a9-cfbc47ed3c33",
      "type": "meta-link"
    },
    {
      "source": "meta-con",
      "target": "8252e196-e572-4453-a7f7-7237558fec11",
      "type": "meta-link"
    }
  ]
};

        // Dimensions
        const width = window.innerWidth;
        const height = window.innerHeight - 70;

        // ========== TEXT PROCESSING UTILITIES ==========

        /**
         * Extract first complete sentence(s) up to a character limit
         */
        function extractFirstSentences(text, maxChars) {
            // Match sentences (ending with . ! ? or .)
            const sentences = text.match(/[^.!?]+[.!?]+/g) || [];

            if (sentences.length === 0) {
                return truncateAtWord(text, maxChars);
            }

            let result = '';
            for (const sentence of sentences) {
                if ((result + sentence).length <= maxChars) {
                    result += sentence;
                } else {
                    break;
                }
            }

            // If we got at least one sentence, return it
            if (result.length > 0) {
                return result.trim();
            }

            // Otherwise, truncate the first sentence at word boundary
            return truncateAtWord(sentences[0], maxChars);
        }

        /**
         * Truncate text at word boundary
         */
        function truncateAtWord(text, maxChars) {
            if (text.length <= maxChars) {
                return text;
            }

            // Find last space before maxChars
            let truncated = text.substring(0, maxChars);
            const lastSpace = truncated.lastIndexOf(' ');

            if (lastSpace > maxChars * 0.6) {
                truncated = truncated.substring(0, lastSpace);
            }

            return truncated.trim() + '...';
        }

        /**
         * Get display text for node based on depth
         */
        function getNodeDisplayText(d) {
            // Meta nodes show full text
            if (d.type === 'meta-pro' || d.type === 'meta-con') {
                return d.text;
            }

            // Character limits based on depth
            const limits = {
                0: 120,  // Root nodes - show more
                1: 90,
                2: 70,
                3: 50,
                4: 35,
                5: 30
            };

            const maxChars = limits[Math.min(d.depth, 5)];
            return extractFirstSentences(d.text, maxChars);
        }

        /**
         * Get tooltip text (2-3 sentences)
         */
        function getTooltipText(d) {
            const preview = extractFirstSentences(d.text, 300);
            return `[${d.type.toUpperCase()}] ${preview}`;
        }

        /**
         * Calculate node radius based on importance and text length
         */
        function getNodeRadius(d) {
            // Meta nodes are MUCH larger to be prominent cluster centers
            if (d.type === 'meta-pro' || d.type === 'meta-con') {
                return 120;
            }

            // Base radius by depth
            const baseRadius = {
                0: 45,  // Root nodes largest
                1: 35,
                2: 30,
                3: 25,
                4: 22,
                5: 20
            };

            const base = baseRadius[Math.min(d.depth, 5)] || 20;

            // Adjust slightly based on text length
            const textFactor = Math.sqrt(d.text.length) * 0.3;

            return base + textFactor;
        }

        /**
         * Get foreignObject dimensions for text wrapping
         */
        function getForeignObjectSize(d) {
            // Meta nodes get much larger text areas
            if (d.type === 'meta-pro' || d.type === 'meta-con') {
                return {
                    width: 320,
                    height: 120
                };
            }

            const widths = {
                0: 200,
                1: 170,
                2: 150,
                3: 120,
                4: 100,
                5: 85
            };

            const heights = {
                0: 70,
                1: 60,
                2: 55,
                3: 50,
                4: 45,
                5: 40
            };

            return {
                width: widths[Math.min(d.depth, 5)] || 85,
                height: heights[Math.min(d.depth, 5)] || 40
            };
        }

        // Create SVG
        const svg = d3.select("#graph")
            .attr("width", width)
            .attr("height", height);

        // Create zoom behavior
        const zoom = d3.zoom()
            .scaleExtent([0.1, 4])
            .on("zoom", (event) => {
                g.attr("transform", event.transform);
            });

        svg.call(zoom);

        // Main group for zoom/pan
        const g = svg.append("g");

        // Define unified arrow markers with clean neutral styling
        const defs = svg.append("defs");

        // Unified neutral arrow for all link types
        const arrowTypes = ['pro', 'con', 'objection', 'response', 'default', 'meta-link'];

        arrowTypes.forEach(type => {
            defs.append("marker")
                .attr("id", `arrow-${type}`)
                .attr("viewBox", "0 -5 10 10")
                .attr("refX", 10) // Position arrow tip at the edge
                .attr("refY", 0)
                .attr("markerWidth", 6)
                .attr("markerHeight", 6)
                .attr("orient", "auto")
                .append("path")
                .attr("d", "M0,-3L10,0L0,3")
                .attr("fill", "#6c757d")
                .attr("opacity", 0.5);
        });

        // Create force simulation with improved parameters to prevent overlap
        const simulation = d3.forceSimulation(graphData.nodes)
            .force("link", d3.forceLink(graphData.links).id(d => d.id).distance(d => {
                // Much longer links for better spacing
                const target = d.target;
                const depth = typeof target === 'object' ? target.depth : 0;
                const sourceRadius = getNodeRadius(d.source);
                const targetRadius = getNodeRadius(target);
                // Significantly increased spacing between nodes
                return Math.max(250, sourceRadius + targetRadius + 150 + (depth * 40));
            }).strength(0.4)) // Reduced from 0.6 to make links more flexible
            .force("charge", d3.forceManyBody()
                .strength(d => {
                    // Strong repulsion to prevent overlap
                    const radius = getNodeRadius(d);
                    return -1500 - (radius * 20); // Increased repulsion
                })
                .distanceMax(1000)) // Increased distance
            .force("center", d3.forceCenter(width / 2, height / 2).strength(0.01))
            .force("x", d3.forceX(width / 2).strength(0.005))
            // Gentler Y-force for softer layering
            .force("y", d3.forceY(d => {
                // Position nodes in horizontal layers based on depth with larger spacing
                const layerHeight = 280;
                const startY = height / 2 - 200;
                return startY + (d.depth + 1) * layerHeight;
            }).strength(0.25)) // Reduced from 0.6 for more flexibility
            .force("collision", d3.forceCollide()
                .radius(d => getNodeRadius(d) + 60) // Increased from 40
                .strength(1.0)
                .iterations(4))
            .alphaDecay(0.015)
            .velocityDecay(0.4);

        // Find meta nodes
        const metaProNode = graphData.nodes.find(n => n.type === 'meta-pro');
        const metaConNode = graphData.nodes.find(n => n.type === 'meta-con');

        // Add custom force to separate meta nodes horizontally and cluster children around them
        if (metaProNode && metaConNode) {
            simulation.force("cluster", function(alpha) {
                const separation = 1400; // Distance between meta nodes

                graphData.nodes.forEach(d => {
                    if (d.type === 'meta-pro') {
                        // Push meta-pro to the left
                        d.vx -= (d.x - (width / 2 - separation / 2)) * 0.15 * alpha;
                    } else if (d.type === 'meta-con') {
                        // Push meta-con to the right
                        d.vx += ((width / 2 + separation / 2) - d.x) * 0.15 * alpha;
                    } else {
                        // Gentle horizontal clustering only (no vertical pull)
                        let targetX;

                        if (d.side === 'pro') {
                            // Pro nodes gently attracted to left cluster
                            targetX = metaProNode.x || (width / 2 - separation / 2);
                        } else {
                            // Con nodes gently attracted to right cluster
                            targetX = metaConNode.x || (width / 2 + separation / 2);
                        }

                        // Very gentle horizontal pull only (removed vertical)
                        const dx = targetX - d.x;
                        d.vx += dx * 0.01 * alpha; // Reduced from 0.04
                    }
                });
            });
        }

        // Create links with arrows using curved paths
        const link = g.append("g")
            .selectAll("path")
            .data(graphData.links)
            .enter().append("path")
            .attr("class", d => `link ${d.type}`)
            .attr("stroke-width", d => {
                const target = d.target;
                const depth = typeof target === 'object' ? target.depth : 0;
                return Math.max(1, 4 - depth);
            })
            .attr("marker-end", d => `url(#arrow-${d.type})`)
            .attr("fill", "none");

        // Create nodes
        const node = g.append("g")
            .selectAll("g")
            .data(graphData.nodes)
            .enter().append("g")
            .attr("class", d => `node ${d.type} ${d.side} depth-${d.depth}`)
            .call(d3.drag()
                .on("start", dragstarted)
                .on("drag", dragged)
                .on("end", dragended));

        // Add circles to nodes (invisible, only for physics)
        node.append("circle")
            .attr("r", d => getNodeRadius(d));

        // Add multi-line labels using foreignObject for better text wrapping
        node.each(function(d) {
            const nodeGroup = d3.select(this);
            const size = getForeignObjectSize(d);
            const displayText = getNodeDisplayText(d);

            // Create foreignObject for HTML text wrapping
            const fo = nodeGroup.append("foreignObject")
                .attr("x", -size.width / 2)
                .attr("y", -size.height / 2)
                .attr("width", size.width)
                .attr("height", size.height)
                .on("click", function(event) {
                    event.stopPropagation();
                    showNodeDetails(d);
                })
                .on("dblclick", function(event) {
                    event.stopPropagation();
                    toggleSubtree(d);
                });

            // Create HTML content with just text (no badges for cleaner look)
            const div = fo.append("xhtml:div")
                .attr("class", "node-label")
                .style("width", "100%")
                .style("height", "100%")
                .style("display", "flex")
                .style("flex-direction", "column")
                .style("align-items", "center")
                .style("justify-content", "center")
                .attr("title", getTooltipText(d));

            // Add text content only (badges removed for cleaner appearance)
            div.append("xhtml:div")
                .attr("class", "node-text-content")
                .style("font-size", d.type === 'meta-pro' || d.type === 'meta-con' ? "17px" : (d.depth === 0 ? "14px" : (d.depth <= 2 ? "12px" : "11px")))
                .style("font-weight", d.type === 'meta-pro' || d.type === 'meta-con' ? "700" : (d.depth === 0 ? "600" : "500"))
                .text(displayText);
        });

        // Helper function to get text box edge point with small gap for arrow
        function getBoxEdgePoint(node, fromX, fromY) {
            const size = getForeignObjectSize(node);
            const halfW = size.width / 2;
            const halfH = size.height / 2;

            // Calculate angle from source to target
            const dx = node.x - fromX;
            const dy = node.y - fromY;
            const angle = Math.atan2(dy, dx);

            // Calculate intersection with rectangle
            const cos = Math.cos(angle);
            const sin = Math.sin(angle);

            // Small gap for arrow (in pixels)
            const gap = 8;

            // Check which edge we hit first
            let x, y;
            if (Math.abs(cos) > Math.abs(sin) * (halfW / halfH)) {
                // Hit left or right edge
                x = node.x - Math.sign(cos) * (halfW + gap);
                y = node.y - Math.tan(angle) * Math.sign(cos) * (halfW + gap);
            } else {
                // Hit top or bottom edge
                y = node.y - Math.sign(sin) * (halfH + gap);
                x = node.x - (y - node.y) / Math.tan(angle);
            }

            return { x, y };
        }

        // Update positions on simulation tick
        simulation.on("tick", () => {
            link.each(function(d) {
                const source = d.source;
                const target = d.target;

                // Get edge points of text boxes
                const sourcePoint = getBoxEdgePoint(source, target.x, target.y);
                const targetPoint = getBoxEdgePoint(target, source.x, source.y);

                // Create straight path
                const pathData = `M ${sourcePoint.x},${sourcePoint.y} L ${targetPoint.x},${targetPoint.y}`;

                d3.select(this).attr("d", pathData);
            });

            node.attr("transform", d => `translate(${d.x},${d.y})`);
        });

        // Drag functions
        function dragstarted(event, d) {
            if (!event.active) simulation.alphaTarget(0.3).restart();
            d.fx = d.x;
            d.fy = d.y;
        }

        function dragged(event, d) {
            d.fx = event.x;
            d.fy = event.y;
        }

        function dragended(event, d) {
            if (!event.active) simulation.alphaTarget(0);
            d.fx = null;
            d.fy = null;
        }

        // Search functionality
        document.getElementById("search").addEventListener("input", (e) => {
            const query = e.target.value.toLowerCase();

            node.classed("highlighted", false);

            if (query) {
                node.classed("highlighted", d =>
                    d.text.toLowerCase().includes(query)
                );
            }
        });

        // ========== SIDEBAR UTILITIES ==========

        /**
         * Get path from root to node (for breadcrumb)
         */
        function getNodePath(nodeId) {
            const path = [];
            let current = graphData.nodes.find(n => n.id === nodeId);

            while (current) {
                path.unshift(current);
                if (current.parent_id) {
                    current = graphData.nodes.find(n => n.id === current.parent_id);
                } else {
                    break;
                }
            }

            return path;
        }

        /**
         * Get all children of a node
         */
        function getChildren(nodeId) {
            return graphData.nodes.filter(n => n.parent_id === nodeId);
        }

        /**
         * Count all descendants recursively
         */
        function countDescendants(nodeId) {
            const children = getChildren(nodeId);
            let count = children.length;

            children.forEach(child => {
                count += countDescendants(child.id);
            });

            return count;
        }

        /**
         * Focus camera on a specific node
         */
        function focusOnNode(nodeId) {
            const nodeData = graphData.nodes.find(n => n.id === nodeId);
            if (!nodeData) return;

            const scale = 1.5;
            const translateX = width / 2 - scale * nodeData.x;
            const translateY = height / 2 - scale * nodeData.y;

            svg.transition().duration(750).call(
                zoom.transform,
                d3.zoomIdentity.translate(translateX, translateY).scale(scale)
            );
        }

        /**
         * Copy text to clipboard
         */
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                // Show brief confirmation
                const btn = event.target;
                const originalText = btn.textContent;
                btn.textContent = '‚úì Copied!';
                setTimeout(() => {
                    btn.textContent = originalText;
                }, 2000);
            });
        }

        // Show node details in sidebar
        function showNodeDetails(d) {
            node.classed("selected", false);
            d3.select(event.target.parentNode).classed("selected", true);

            const sidebar = document.getElementById("sidebar");
            const sidebarHeader = document.getElementById("sidebar-header");
            const sidebarBody = document.getElementById("sidebar-body");

            // Build breadcrumb
            const path = getNodePath(d.id);
            let breadcrumbHtml = '<div class="breadcrumb">';
            path.forEach((node, index) => {
                if (index > 0) {
                    breadcrumbHtml += '<span class="breadcrumb-separator">‚Ä∫</span>';
                }
                const truncated = truncateAtWord(node.text, 30);
                breadcrumbHtml += `<span class="breadcrumb-item" onclick="showNodeDetails(graphData.nodes.find(n => n.id === '${node.id}'))">${truncated}</span>`;
            });
            breadcrumbHtml += '</div>';

            // Header with breadcrumb
            sidebarHeader.innerHTML = `
                <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                    <span class="node-badge-large ${d.type}">${d.type}</span>
                    <span class="node-badge-large ${d.side}">${d.side}</span>
                </div>
                <h2>Argument Details</h2>
                ${breadcrumbHtml}
            `;

            // Get children and descendants
            const children = getChildren(d.id);
            const descendantCount = countDescendants(d.id);

            // Build body content
            let bodyHtml = `
                <!-- Main Argument Section -->
                <div class="section">
                    <div class="section-title">üìù Argument</div>
                    <div class="node-text">${d.text}</div>
                </div>

                <!-- Action Buttons -->
                <div class="action-buttons">
                    <button class="action-btn primary" onclick="focusOnNode('${d.id}')">
                        üéØ Focus
                    </button>
                    <button class="action-btn" onclick="copyToClipboard(\`${d.text.replace(/`/g, '\\`')}\`)">
                        üìã Copy
                    </button>
                </div>

                <!-- Statistics -->
                <div class="stats-row">
                    <div class="stat-box">
                        <div class="stat-box-value">${d.depth}</div>
                        <div class="stat-box-label">Depth</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-box-value">${children.length}</div>
                        <div class="stat-box-label">Children</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-box-value">${descendantCount}</div>
                        <div class="stat-box-label">Descendants</div>
                    </div>
                </div>

                <!-- Metadata Grid -->
                <div class="section">
                    <div class="section-title">‚ÑπÔ∏è Metadata</div>
                    <div class="meta-grid">
                        <div class="meta-item">
                            <div class="meta-label">Source</div>
                            <div class="meta-value">${d.source}</div>
                        </div>
                        <div class="meta-item">
                            <div class="meta-label">Created</div>
                            <div class="meta-value">${new Date(d.created_at).toLocaleDateString()}</div>
                        </div>
                    </div>
                </div>
            `;

            // Add children section
            if (children.length > 0) {
                // Determine label based on node type
                let childrenLabel;
                if (d.type === 'meta-pro') {
                    childrenLabel = `${children.length} Supporting ${children.length === 1 ? 'Argument' : 'Arguments'}`;
                } else if (d.type === 'meta-con') {
                    childrenLabel = `${children.length} Opposing ${children.length === 1 ? 'Argument' : 'Arguments'}`;
                } else {
                    childrenLabel = `${children.length} ${children.length === 1 ? 'Response' : 'Responses'}`;
                }

                bodyHtml += `
                    <div class="section">
                        <div class="section-title">üå≥ ${childrenLabel}</div>
                `;

                children.forEach(child => {
                    const preview = truncateAtWord(child.text, 150);
                    bodyHtml += `
                        <div class="child-node ${child.type}" onclick="showNodeDetails(graphData.nodes.find(n => n.id === '${child.id}'))">
                            <div class="child-node-header">
                                <span class="child-node-badge ${child.type}" style="
                                    background: ${child.type === 'pro' ? '#d5f0e8' : child.type === 'con' ? '#f7e0e0' : child.type === 'objection' ? '#ffecd9' : '#e3eef8'};
                                    color: ${child.type === 'pro' ? '#2d9e7e' : child.type === 'con' ? '#c74848' : child.type === 'objection' ? '#d97a30' : '#4a7fb8'};
                                ">${child.type}</span>
                                <span style="font-size: 0.75em; color: #72777d;">${child.children_count} ${child.children_count === 1 ? 'reply' : 'replies'}</span>
                            </div>
                            <div class="child-node-text">${preview}</div>
                        </div>
                    `;
                });

                bodyHtml += '</div>';
            } else {
                bodyHtml += `
                    <div class="section">
                        <div class="empty-state">
                            <div style="font-size: 2em; margin-bottom: 10px;">üí≠</div>
                            <div>No responses yet</div>
                            <div style="font-size: 0.85em; margin-top: 5px;">This is a leaf node in the argument tree</div>
                        </div>
                    </div>
                `;
            }

            // Add references section
            if (d.references && d.references.length > 0) {
                bodyHtml += `
                    <div class="section">
                        <div class="section-title">üîó References</div>
                        <ul class="references-list">
                `;

                d.references.forEach(ref => {
                    bodyHtml += `<li><a href="${ref}" target="_blank">${ref}</a></li>`;
                });

                bodyHtml += `
                        </ul>
                    </div>
                `;
            }

            sidebarBody.innerHTML = bodyHtml;
            sidebar.classList.add("open");
        }

        function closeSidebar() {
            document.getElementById("sidebar").classList.remove("open");
            node.classed("selected", false);
        }

        // Click outside to close sidebar
        svg.on("click", () => {
            closeSidebar();
        });

        // Button handlers - Reset and fit view
        function resetAndFit() {
            // Clear search and highlights
            document.getElementById("search").value = "";
            node.classed("highlighted", false);
            closeSidebar();

            // Fit graph to view with animation
            const bounds = g.node().getBBox();
            const fullWidth = width;
            const fullHeight = height;
            const widthScale = fullWidth / bounds.width;
            const heightScale = fullHeight / bounds.height;
            const scale = Math.min(widthScale, heightScale) * 0.85;
            const translateX = fullWidth / 2 - scale * (bounds.x + bounds.width / 2);
            const translateY = fullHeight / 2 - scale * (bounds.y + bounds.height / 2);

            svg.transition().duration(750).call(
                zoom.transform,
                d3.zoomIdentity.translate(translateX, translateY).scale(scale)
            );
        }

        function toggleSubtree(d) {
            // TODO: Implement toggle subtree
            console.log("Toggle subtree not yet implemented for", d.id);
        }

        // Handle window resize
        window.addEventListener("resize", () => {
            const newWidth = window.innerWidth;
            const newHeight = window.innerHeight - 70;
            svg.attr("width", newWidth).attr("height", newHeight);
            simulation.force("center", d3.forceCenter(newWidth / 2, newHeight / 2));
            simulation.alpha(0.3).restart();
        });
    </script>
</body>
</html>